<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib\client\node_crawler.js - The NodeOPCUA API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="The NodeOPCUA API" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.52</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AcknowledgeMessage.html">AcknowledgeMessage</a></li>
                                <li><a href="../classes/ActivateSessionRequest.html">ActivateSessionRequest</a></li>
                                <li><a href="../classes/ActivateSessionResponse.html">ActivateSessionResponse</a></li>
                                <li><a href="../classes/AddNodesItem.html">AddNodesItem</a></li>
                                <li><a href="../classes/AddNodesRequest.html">AddNodesRequest</a></li>
                                <li><a href="../classes/AddNodesResponse.html">AddNodesResponse</a></li>
                                <li><a href="../classes/AddNodesResult.html">AddNodesResult</a></li>
                                <li><a href="../classes/AddReferencesItem.html">AddReferencesItem</a></li>
                                <li><a href="../classes/AddReferencesRequest.html">AddReferencesRequest</a></li>
                                <li><a href="../classes/AddReferencesResponse.html">AddReferencesResponse</a></li>
                                <li><a href="../classes/AddressSpace.html">AddressSpace</a></li>
                                <li><a href="../classes/AggregateConfiguration.html">AggregateConfiguration</a></li>
                                <li><a href="../classes/AnonymousIdentityToken.html">AnonymousIdentityToken</a></li>
                                <li><a href="../classes/ApplicationDescription.html">ApplicationDescription</a></li>
                                <li><a href="../classes/ApplicationType.html">ApplicationType</a></li>
                                <li><a href="../classes/Argument.html">Argument</a></li>
                                <li><a href="../classes/AsymmetricAlgorithmSecurityHeader.html">AsymmetricAlgorithmSecurityHeader</a></li>
                                <li><a href="../classes/AttributeIds.html">AttributeIds</a></li>
                                <li><a href="../classes/AttributeNameById.html">AttributeNameById</a></li>
                                <li><a href="../classes/AttributeOperand.html">AttributeOperand</a></li>
                                <li><a href="../classes/AxisInformation.html">AxisInformation</a></li>
                                <li><a href="../classes/BaseNode.html">BaseNode</a></li>
                                <li><a href="../classes/BaseUAObject.html">BaseUAObject</a></li>
                                <li><a href="../classes/BinaryStream.html">BinaryStream</a></li>
                                <li><a href="../classes/BinaryStreamSizeCalculator.html">BinaryStreamSizeCalculator</a></li>
                                <li><a href="../classes/BrowseDescription.html">BrowseDescription</a></li>
                                <li><a href="../classes/BrowseNextRequest.html">BrowseNextRequest</a></li>
                                <li><a href="../classes/BrowseNextResponse.html">BrowseNextResponse</a></li>
                                <li><a href="../classes/BrowsePath.html">BrowsePath</a></li>
                                <li><a href="../classes/BrowsePathResult.html">BrowsePathResult</a></li>
                                <li><a href="../classes/BrowsePathTarget.html">BrowsePathTarget</a></li>
                                <li><a href="../classes/BrowseRequest.html">BrowseRequest</a></li>
                                <li><a href="../classes/BrowseResponse.html">BrowseResponse</a></li>
                                <li><a href="../classes/BrowseResult.html">BrowseResult</a></li>
                                <li><a href="../classes/BuildInfo.html">BuildInfo</a></li>
                                <li><a href="../classes/CallMethodRequest.html">CallMethodRequest</a></li>
                                <li><a href="../classes/CallMethodResult.html">CallMethodResult</a></li>
                                <li><a href="../classes/CallRequest.html">CallRequest</a></li>
                                <li><a href="../classes/CallResponse.html">CallResponse</a></li>
                                <li><a href="../classes/CancelRequest.html">CancelRequest</a></li>
                                <li><a href="../classes/CancelResponse.html">CancelResponse</a></li>
                                <li><a href="../classes/ChannelSecurityToken.html">ChannelSecurityToken</a></li>
                                <li><a href="../classes/ChunkManager.html">ChunkManager</a></li>
                                <li><a href="../classes/ClientMonitoredItem.html">ClientMonitoredItem</a></li>
                                <li><a href="../classes/ClientSecureChannelLayer.html">ClientSecureChannelLayer</a></li>
                                <li><a href="../classes/ClientSession.html">ClientSession</a></li>
                                <li><a href="../classes/ClientSidePublishEngine.html">ClientSidePublishEngine</a></li>
                                <li><a href="../classes/ClientSubscription.html">ClientSubscription</a></li>
                                <li><a href="../classes/ClientTCP_transport.html">ClientTCP_transport</a></li>
                                <li><a href="../classes/CloseSecureChannelRequest.html">CloseSecureChannelRequest</a></li>
                                <li><a href="../classes/CloseSecureChannelResponse.html">CloseSecureChannelResponse</a></li>
                                <li><a href="../classes/CloseSessionRequest.html">CloseSessionRequest</a></li>
                                <li><a href="../classes/CloseSessionResponse.html">CloseSessionResponse</a></li>
                                <li><a href="../classes/ContentFilter.html">ContentFilter</a></li>
                                <li><a href="../classes/ContentFilterElement.html">ContentFilterElement</a></li>
                                <li><a href="../classes/ContentFilterElementResult.html">ContentFilterElementResult</a></li>
                                <li><a href="../classes/ContentFilterResult.html">ContentFilterResult</a></li>
                                <li><a href="../classes/CreateMonitoredItemsRequest.html">CreateMonitoredItemsRequest</a></li>
                                <li><a href="../classes/CreateMonitoredItemsResponse.html">CreateMonitoredItemsResponse</a></li>
                                <li><a href="../classes/CreateSessionRequest.html">CreateSessionRequest</a></li>
                                <li><a href="../classes/CreateSessionResponse.html">CreateSessionResponse</a></li>
                                <li><a href="../classes/CreateSubscriptionRequest.html">CreateSubscriptionRequest</a></li>
                                <li><a href="../classes/CreateSubscriptionResponse.html">CreateSubscriptionResponse</a></li>
                                <li><a href="../classes/cryptoutils.html">cryptoutils</a></li>
                                <li><a href="../classes/DataChangeFilter.html">DataChangeFilter</a></li>
                                <li><a href="../classes/DataChangeNotification.html">DataChangeNotification</a></li>
                                <li><a href="../classes/DataValue.html">DataValue</a></li>
                                <li><a href="../classes/DeleteMonitoredItemsRequest.html">DeleteMonitoredItemsRequest</a></li>
                                <li><a href="../classes/DeleteMonitoredItemsResponse.html">DeleteMonitoredItemsResponse</a></li>
                                <li><a href="../classes/DeleteNodesItem.html">DeleteNodesItem</a></li>
                                <li><a href="../classes/DeleteNodesRequest.html">DeleteNodesRequest</a></li>
                                <li><a href="../classes/DeleteNodesResponse.html">DeleteNodesResponse</a></li>
                                <li><a href="../classes/DeleteReferencesItem.html">DeleteReferencesItem</a></li>
                                <li><a href="../classes/DeleteReferencesRequest.html">DeleteReferencesRequest</a></li>
                                <li><a href="../classes/DeleteReferencesResponse.html">DeleteReferencesResponse</a></li>
                                <li><a href="../classes/DeleteSubscriptionsRequest.html">DeleteSubscriptionsRequest</a></li>
                                <li><a href="../classes/DeleteSubscriptionsResponse.html">DeleteSubscriptionsResponse</a></li>
                                <li><a href="../classes/DiagnosticInfo.html">DiagnosticInfo</a></li>
                                <li><a href="../classes/ElementOperand.html">ElementOperand</a></li>
                                <li><a href="../classes/EncodeDecode.html">EncodeDecode</a></li>
                                <li><a href="../classes/EndpointDescription.html">EndpointDescription</a></li>
                                <li><a href="../classes/Enum.html">Enum</a></li>
                                <li><a href="../classes/EnumValueType.html">EnumValueType</a></li>
                                <li><a href="../classes/ErrorMessage.html">ErrorMessage</a></li>
                                <li><a href="../classes/EUInformation.html">EUInformation</a></li>
                                <li><a href="../classes/EventFieldList.html">EventFieldList</a></li>
                                <li><a href="../classes/EventFilter.html">EventFilter</a></li>
                                <li><a href="../classes/EventFilterResult.html">EventFilterResult</a></li>
                                <li><a href="../classes/EventNotificationList.html">EventNotificationList</a></li>
                                <li><a href="../classes/ExpandedNodeId.html">ExpandedNodeId</a></li>
                                <li><a href="../classes/Factory.html">Factory</a></li>
                                <li><a href="../classes/FilterOperand.html">FilterOperand</a></li>
                                <li><a href="../classes/FilterOperator.html">FilterOperator</a></li>
                                <li><a href="../classes/FindServersRequest.html">FindServersRequest</a></li>
                                <li><a href="../classes/FindServersResponse.html">FindServersResponse</a></li>
                                <li><a href="../classes/GetEndpointsRequest.html">GetEndpointsRequest</a></li>
                                <li><a href="../classes/GetEndpointsResponse.html">GetEndpointsResponse</a></li>
                                <li><a href="../classes/HelloMessage.html">HelloMessage</a></li>
                                <li><a href="../classes/HistoryData.html">HistoryData</a></li>
                                <li><a href="../classes/HistoryModifiedData.html">HistoryModifiedData</a></li>
                                <li><a href="../classes/HistoryReadDetails.html">HistoryReadDetails</a></li>
                                <li><a href="../classes/HistoryReadRequest.html">HistoryReadRequest</a></li>
                                <li><a href="../classes/HistoryReadResponse.html">HistoryReadResponse</a></li>
                                <li><a href="../classes/HistoryReadResult.html">HistoryReadResult</a></li>
                                <li><a href="../classes/HistoryReadValueId.html">HistoryReadValueId</a></li>
                                <li><a href="../classes/HistoryUpdateRequest.html">HistoryUpdateRequest</a></li>
                                <li><a href="../classes/HistoryUpdateResponse.html">HistoryUpdateResponse</a></li>
                                <li><a href="../classes/HistoryUpdateResult.html">HistoryUpdateResult</a></li>
                                <li><a href="../classes/IssuedIdentityToken.html">IssuedIdentityToken</a></li>
                                <li><a href="../classes/LiteralOperand.html">LiteralOperand</a></li>
                                <li><a href="../classes/LocalizedText.html">LocalizedText</a></li>
                                <li><a href="../classes/MessageBuilder.html">MessageBuilder</a></li>
                                <li><a href="../classes/MessageBuilderBase.html">MessageBuilderBase</a></li>
                                <li><a href="../classes/MessageChunker.html">MessageChunker</a></li>
                                <li><a href="../classes/MessageSecurityMode.html">MessageSecurityMode</a></li>
                                <li><a href="../classes/ModelChangeStructure.html">ModelChangeStructure</a></li>
                                <li><a href="../classes/ModificationInfo.html">ModificationInfo</a></li>
                                <li><a href="../classes/ModifyMonitoredItemsRequest.html">ModifyMonitoredItemsRequest</a></li>
                                <li><a href="../classes/ModifyMonitoredItemsResponse.html">ModifyMonitoredItemsResponse</a></li>
                                <li><a href="../classes/ModifySubscriptionRequest.html">ModifySubscriptionRequest</a></li>
                                <li><a href="../classes/ModifySubscriptionResponse.html">ModifySubscriptionResponse</a></li>
                                <li><a href="../classes/MonitoredItem.html">MonitoredItem</a></li>
                                <li><a href="../classes/MonitoredItemCreateRequest.html">MonitoredItemCreateRequest</a></li>
                                <li><a href="../classes/MonitoredItemCreateResult.html">MonitoredItemCreateResult</a></li>
                                <li><a href="../classes/MonitoredItemModifyRequest.html">MonitoredItemModifyRequest</a></li>
                                <li><a href="../classes/MonitoredItemModifyResult.html">MonitoredItemModifyResult</a></li>
                                <li><a href="../classes/MonitoredItemNotification.html">MonitoredItemNotification</a></li>
                                <li><a href="../classes/MonitoringFilter.html">MonitoringFilter</a></li>
                                <li><a href="../classes/MonitoringParameters.html">MonitoringParameters</a></li>
                                <li><a href="../classes/MyStructure.html">MyStructure</a></li>
                                <li><a href="../classes/NodeCrawler.html">NodeCrawler</a></li>
                                <li><a href="../classes/NodeId.html">NodeId</a></li>
                                <li><a href="../classes/NodeIdType.html">NodeIdType</a></li>
                                <li><a href="../classes/NodeTypeDescription.html">NodeTypeDescription</a></li>
                                <li><a href="../classes/NotificationMessage.html">NotificationMessage</a></li>
                                <li><a href="../classes/opcua.html">opcua</a></li>
                                <li><a href="../classes/OPCUABaseServer.html">OPCUABaseServer</a></li>
                                <li><a href="../classes/OPCUAClient.html">OPCUAClient</a></li>
                                <li><a href="../classes/OPCUAClientBase.html">OPCUAClientBase</a></li>
                                <li><a href="../classes/OPCUASecureObject.html">OPCUASecureObject</a></li>
                                <li><a href="../classes/OPCUAServer.html">OPCUAServer</a></li>
                                <li><a href="../classes/OPCUAServerEndPoint
                
                A sever end point is listening to one port.html">OPCUAServerEndPoint
                
                A sever end point is listening to one port</a></li>
                                <li><a href="../classes/OpenSecureChannelRequest.html">OpenSecureChannelRequest</a></li>
                                <li><a href="../classes/OpenSecureChannelResponse.html">OpenSecureChannelResponse</a></li>
                                <li><a href="../classes/PacketAssembler.html">PacketAssembler</a></li>
                                <li><a href="../classes/ParsingResult.html">ParsingResult</a></li>
                                <li><a href="../classes/PublishRequest.html">PublishRequest</a></li>
                                <li><a href="../classes/PublishResponse.html">PublishResponse</a></li>
                                <li><a href="../classes/QualifiedName.html">QualifiedName</a></li>
                                <li><a href="../classes/QueryDataDescription.html">QueryDataDescription</a></li>
                                <li><a href="../classes/QueryDataSet.html">QueryDataSet</a></li>
                                <li><a href="../classes/QueryFirstRequest.html">QueryFirstRequest</a></li>
                                <li><a href="../classes/QueryFirstResponse.html">QueryFirstResponse</a></li>
                                <li><a href="../classes/QueryNextRequest.html">QueryNextRequest</a></li>
                                <li><a href="../classes/QueryNextResponse.html">QueryNextResponse</a></li>
                                <li><a href="../classes/Range.html">Range</a></li>
                                <li><a href="../classes/ReadAtTimeDetails.html">ReadAtTimeDetails</a></li>
                                <li><a href="../classes/ReaderState.html">ReaderState</a></li>
                                <li><a href="../classes/ReadEventDetails.html">ReadEventDetails</a></li>
                                <li><a href="../classes/ReadProcessedDetails.html">ReadProcessedDetails</a></li>
                                <li><a href="../classes/ReadRawModifiedDetails.html">ReadRawModifiedDetails</a></li>
                                <li><a href="../classes/ReadRequest.html">ReadRequest</a></li>
                                <li><a href="../classes/ReadResponse.html">ReadResponse</a></li>
                                <li><a href="../classes/ReadValueId.html">ReadValueId</a></li>
                                <li><a href="../classes/RedundantServer.html">RedundantServer</a></li>
                                <li><a href="../classes/Reference.html">Reference</a></li>
                                <li><a href="../classes/ReferenceDescription.html">ReferenceDescription</a></li>
                                <li><a href="../classes/ReferenceType.html">ReferenceType</a></li>
                                <li><a href="../classes/RegisteredServer.html">RegisteredServer</a></li>
                                <li><a href="../classes/RegisterNodesRequest.html">RegisterNodesRequest</a></li>
                                <li><a href="../classes/RegisterNodesResponse.html">RegisterNodesResponse</a></li>
                                <li><a href="../classes/RegisterServerRequest.html">RegisterServerRequest</a></li>
                                <li><a href="../classes/RegisterServerResponse.html">RegisterServerResponse</a></li>
                                <li><a href="../classes/RelativePath.html">RelativePath</a></li>
                                <li><a href="../classes/RelativePathElement.html">RelativePathElement</a></li>
                                <li><a href="../classes/RepublishRequest.html">RepublishRequest</a></li>
                                <li><a href="../classes/RepublishResponse.html">RepublishResponse</a></li>
                                <li><a href="../classes/RequestHeader.html">RequestHeader</a></li>
                                <li><a href="../classes/ResponseHeader.html">ResponseHeader</a></li>
                                <li><a href="../classes/SamplingIntervalDiagnostics.html">SamplingIntervalDiagnostics</a></li>
                                <li><a href="../classes/SecureMessageChunkManager.html">SecureMessageChunkManager</a></li>
                                <li><a href="../classes/SecurityPolicy.html">SecurityPolicy</a></li>
                                <li><a href="../classes/SecurityTokenRequestType.html">SecurityTokenRequestType</a></li>
                                <li><a href="../classes/SemanticChangeStructure.html">SemanticChangeStructure</a></li>
                                <li><a href="../classes/SequenceHeader.html">SequenceHeader</a></li>
                                <li><a href="../classes/SequenceNumberGenerator.html">SequenceNumberGenerator</a></li>
                                <li><a href="../classes/ServerDiagnosticsSummary.html">ServerDiagnosticsSummary</a></li>
                                <li><a href="../classes/ServerEngine.html">ServerEngine</a></li>
                                <li><a href="../classes/ServerSecureChannelLayer.html">ServerSecureChannelLayer</a></li>
                                <li><a href="../classes/ServerSession.html">ServerSession</a></li>
                                <li><a href="../classes/ServerSidePublishEngine.html">ServerSidePublishEngine</a></li>
                                <li><a href="../classes/ServerStatus.html">ServerStatus</a></li>
                                <li><a href="../classes/ServerTCP_transport.html">ServerTCP_transport</a></li>
                                <li><a href="../classes/ServiceCounter.html">ServiceCounter</a></li>
                                <li><a href="../classes/ServiceFault.html">ServiceFault</a></li>
                                <li><a href="../classes/SessionDiagnostics.html">SessionDiagnostics</a></li>
                                <li><a href="../classes/SessionSecurityDiagnostics.html">SessionSecurityDiagnostics</a></li>
                                <li><a href="../classes/SetMonitoringModeRequest.html">SetMonitoringModeRequest</a></li>
                                <li><a href="../classes/SetMonitoringModeResponse.html">SetMonitoringModeResponse</a></li>
                                <li><a href="../classes/SetPublishingModeRequest.html">SetPublishingModeRequest</a></li>
                                <li><a href="../classes/SetPublishingModeResponse.html">SetPublishingModeResponse</a></li>
                                <li><a href="../classes/SetTriggeringRequest.html">SetTriggeringRequest</a></li>
                                <li><a href="../classes/SetTriggeringResponse.html">SetTriggeringResponse</a></li>
                                <li><a href="../classes/SignatureData.html">SignatureData</a></li>
                                <li><a href="../classes/SignedSoftwareCertificate.html">SignedSoftwareCertificate</a></li>
                                <li><a href="../classes/SimpleAttributeOperand.html">SimpleAttributeOperand</a></li>
                                <li><a href="../classes/Simulator.html">Simulator</a></li>
                                <li><a href="../classes/StatusChangeNotification.html">StatusChangeNotification</a></li>
                                <li><a href="../classes/StatusCode.html">StatusCode</a></li>
                                <li><a href="../classes/Subscription.html">Subscription</a></li>
                                <li><a href="../classes/SubscriptionAcknowledgement.html">SubscriptionAcknowledgement</a></li>
                                <li><a href="../classes/SubscriptionDiagnostics.html">SubscriptionDiagnostics</a></li>
                                <li><a href="../classes/SymmetricAlgorithmSecurityHeader.html">SymmetricAlgorithmSecurityHeader</a></li>
                                <li><a href="../classes/TCP_transport.html">TCP_transport</a></li>
                                <li><a href="../classes/TCPErrorMessage.html">TCPErrorMessage</a></li>
                                <li><a href="../classes/TimestampsToReturn.html">TimestampsToReturn</a></li>
                                <li><a href="../classes/ToolBrowsePath.html">ToolBrowsePath</a></li>
                                <li><a href="../classes/TransferResult.html">TransferResult</a></li>
                                <li><a href="../classes/TransferSubscriptionsRequest.html">TransferSubscriptionsRequest</a></li>
                                <li><a href="../classes/TransferSubscriptionsResponse.html">TransferSubscriptionsResponse</a></li>
                                <li><a href="../classes/TranslateBrowsePathsToNodeIdsRequest.html">TranslateBrowsePathsToNodeIdsRequest</a></li>
                                <li><a href="../classes/TranslateBrowsePathsToNodeIdsResponse.html">TranslateBrowsePathsToNodeIdsResponse</a></li>
                                <li><a href="../classes/TypeSchema.html">TypeSchema</a></li>
                                <li><a href="../classes/UADataType.html">UADataType</a></li>
                                <li><a href="../classes/UAObject.html">UAObject</a></li>
                                <li><a href="../classes/UAObjectType.html">UAObjectType</a></li>
                                <li><a href="../classes/UAVariable.html">UAVariable</a></li>
                                <li><a href="../classes/UAVariableType.html">UAVariableType</a></li>
                                <li><a href="../classes/UnregisterNodesRequest.html">UnregisterNodesRequest</a></li>
                                <li><a href="../classes/UnregisterNodesResponse.html">UnregisterNodesResponse</a></li>
                                <li><a href="../classes/UserIdentityTokenType.html">UserIdentityTokenType</a></li>
                                <li><a href="../classes/UserNameIdentityToken.html">UserNameIdentityToken</a></li>
                                <li><a href="../classes/UserTokenPolicy.html">UserTokenPolicy</a></li>
                                <li><a href="../classes/Variant.html">Variant</a></li>
                                <li><a href="../classes/View.html">View</a></li>
                                <li><a href="../classes/ViewDescription.html">ViewDescription</a></li>
                                <li><a href="../classes/WriteRequest.html">WriteRequest</a></li>
                                <li><a href="../classes/WriteResponse.html">WriteResponse</a></li>
                                <li><a href="../classes/WriteValue.html">WriteValue</a></li>
                                <li><a href="../classes/X509IdentityToken.html">X509IdentityToken</a></li>
                                <li><a href="../classes/Xml2Json.html">Xml2Json</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/opcua.address_space.html">opcua.address_space</a></li>
                                <li><a href="../modules/opcua.address_space.types.html">opcua.address_space.types</a></li>
                                <li><a href="../modules/opcua.client.html">opcua.client</a></li>
                                <li><a href="../modules/opcua.datamodel.html">opcua.datamodel</a></li>
                                <li><a href="../modules/opcua.helpers.html">opcua.helpers</a></li>
                                <li><a href="../modules/opcua.miscellaneous.html">opcua.miscellaneous</a></li>
                                <li><a href="../modules/opcua.server.html">opcua.server</a></li>
                                <li><a href="../modules/opcua.server.simulation.html">opcua.server.simulation</a></li>
                                <li><a href="../modules/opcua.transport.html">opcua.transport</a></li>
                                <li><a href="../modules/services.browse.html">services.browse</a></li>
                                <li><a href="../modules/services.get_endpoints.html">services.get_endpoints</a></li>
                                <li><a href="../modules/services.historizing.html">services.historizing</a></li>
                                <li><a href="../modules/services.method.html">services.method</a></li>
                                <li><a href="../modules/services.read.html">services.read</a></li>
                                <li><a href="../modules/services.register.html">services.register</a></li>
                                <li><a href="../modules/services.session.html">services.session</a></li>
                                <li><a href="../modules/services.subscription.html">services.subscription</a></li>
                                <li><a href="../modules/services.write.html">services.write</a></li>
                                <li><a href="../modules/StatusCodes.html">StatusCodes</a></li>
                                <li><a href="../modules/xml2json.html">xml2json</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: lib\client\node_crawler.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&quot;use strict&quot;;
require(&quot;requirish&quot;)._(module);

var opcua = require(&quot;index.js&quot;);
var AttributeIds = opcua.AttributeIds;
//xx var AttributeNameById = opcua.AttributeNameById;
var BrowseDirection = opcua.browse_service.BrowseDirection;
var BrowseDescription = opcua.browse_service.BrowseDescription;
var async = require(&quot;async&quot;);
var _ = require(&quot;underscore&quot;);
var util = require(&quot;util&quot;);
var EventEmitter = require(&quot;events&quot;).EventEmitter;
var resolveNodeId = opcua.resolveNodeId;
var NodeId = opcua.NodeId;
var StatusCodes = opcua.StatusCodes;
var assert = require(&quot;better-assert&quot;);

var utils = require(&quot;lib/misc/utils&quot;);
var debugLog = utils.make_debugLog(__filename);
//xx var doDebug = utils.checkDebugFlag(__filename);
//
// some server do not expose the ReferenceType Node in their address space
// ReferenceType are defined by the OPCUA standard and can be prepopulated in the crawler.
// Pre-populating the ReferenceType node in the crawler will also reduce the network traffic.
//
var ReferenceTypeIds = require(&quot;lib/opcua_node_ids&quot;).ReferenceTypeIds;
var makeNodeId = require(&quot;lib/datamodel/nodeid&quot;).makeNodeId;


/*=
 *
 * @param arr
 * @param maxNode
 * @private
 * @return {*}
 */
function _fetch_elements(arr, maxNode) {
    assert(_.isArray(arr));
    assert(arr.length &gt; 0);
    var high_limit = ( maxNode &lt;= 0) ? arr.length : maxNode;
    var tmp = arr.splice(0, high_limit);
    assert(tmp.length &gt; 0);
    return tmp;
}

/**
 * @class NodeCrawler
 * @param session
 * @constructor
 */
function NodeCrawler(session) {

    var self = this;

    self.session = session;

    self.browseNameMap = {};
    self._nodesToReadEx = [];
    self._objectCache = {};
    self._objectToBrowse = [];
    self._objMap = {};

    this._initialize_referenceTypeId();

    self.q = async.queue(function (task, callback) {

        // use process next tick to relax the stack frame
        setImmediate(function () {
            task.func.call(self, task, function () {
                self.resolve_deferred_browseNode();
                self.resolve_deferred_readNode();
                callback();
            });
        });

    }, 1);

    // MaxNodesPerRead from Server.ServerCapabilities.OperationLimits
    // VariableIds.ServerType_ServerCapabilities_OperationLimits_MaxNodesPerRead
    self.maxNodesPerRead = 0;

    //  MaxNodesPerBrowse from Server.ServerCapabilities.OperationLimits
    // VariableIds.Server_ServerCapabilities_OperationLimits_MaxNodesPerBrowse;
    self.maxNodesPerBrowse = 0; // 0 = no limits
}

util.inherits(NodeCrawler, EventEmitter);

NodeCrawler.prototype._initialize_referenceTypeId = function () {

    var self = this;

    function append_prepopulated_reference(browseName) {

        var nodeId = makeNodeId(ReferenceTypeIds[browseName], 0);
        assert(nodeId);
        var ref_index = nodeId.toString();
        var obj = {
            nodeId: nodeId,
            browseName: {name: browseName},
            references: []
        };
        self._objectCache[ref_index] = obj;
    }

    //  References
    //  +-&gt;(hasSubtype) NoHierarchicalReferences
    //                  +-&gt;(hasSubtype) HasTypeDefinition
    //  +-&gt;(hasSubtype) HierarchicalReferences
    //                  +-&gt;(hasSubtype) HasChild/ChildOf
    //                                  +-&gt;(hasSubtype) Aggregates/AggregatedBy
    //                                                  +-&gt; HasProperty/PropertyOf
    //                                                  +-&gt; HasComponent/ComponentOf
    //                                                  +-&gt; HasHistoricalConfiguration/HistoricalConfigurationOf
    //                                 +-&gt;(hasSubtype) HasSubtype/HasSupertype
    //                  +-&gt;(hasSubtype) Organizes/OrganizedBy
    //                  +-&gt;(hasSubtype) HasEventSource/EventSourceOf
    append_prepopulated_reference(&quot;HasTypeDefinition&quot;);
    append_prepopulated_reference(&quot;HasChild&quot;);
    append_prepopulated_reference(&quot;HasProperty&quot;);
    append_prepopulated_reference(&quot;HasComponent&quot;);
    append_prepopulated_reference(&quot;HasHistoricalConfiguration&quot;);
    append_prepopulated_reference(&quot;HasSubtype&quot;);
    append_prepopulated_reference(&quot;Organizes&quot;);
    append_prepopulated_reference(&quot;HasEventSource&quot;);

};

NodeCrawler.prototype._readOperationalLimits = function (callback) {

    var self = this;
    var n1 = makeNodeId(opcua.VariableIds.Server_ServerCapabilities_OperationLimits_MaxNodesPerRead);
    var n2 = makeNodeId(opcua.VariableIds.Server_ServerCapabilities_OperationLimits_MaxNodesPerBrowse);
    var nodesToRead = [
        {nodeId: n1, attributeId: AttributeIds.Value},
        {nodeId: n2, attributeId: AttributeIds.Value}
    ];
    self.session.read(nodesToRead, function (err, nodeIds, results) {
        if (!err) {
            if (results[0].statusCode === StatusCodes.Good) {
                self.maxNodesPerRead = results[0].value.value;
            }
            // ensure we have a sensible maxNodesPerRead value in case the server doesn&#x27;t specify one
            self.maxNodesPerRead = self.maxNodesPerRead || 200;

            if (results[1].statusCode === StatusCodes.Good) {
                self.maxNodesPerBrowse = results[1].value.value;
            }
            // ensure we have a sensible maxNodesPerBrowse value in case the server doesn&#x27;t specify one
            self.maxNodesPerBrowse = self.maxNodesPerBrowse || 100;
        }
        callback(err);
    });
};

NodeCrawler.prototype.set_cache_NodeAttribute = function (nodeId, attributeId, value) {
    var self = this;
    var index = nodeId.toString() + &quot;_&quot; + attributeId.toString();
    self.browseNameMap[index] = value;
};

NodeCrawler.prototype.has_cache_NodeAttribute = function (nodeId, attributeId) {
    var self = this;
    var index = nodeId.toString() + &quot;_&quot; + attributeId.toString();
    return self.browseNameMap.hasOwnProperty(index);
};

NodeCrawler.prototype.get_cache_NodeAttribute = function (nodeId, attributeId) {
    var self = this;
    var index = nodeId.toString() + &quot;_&quot; + attributeId.toString();
    return self.browseNameMap[index];
};

/**
 * request a read operation for a Node+Attribute in the future, provides a callback
 *
 * @method _defer_readNode
 * @param nodeId {NodeId}
 * @param attributeId {AttributeId}
 * @param {function} callback
 * @param {Error|null} callback.err
 * @param {string} callback.dataValue
 * @private
 */
NodeCrawler.prototype._defer_readNode = function (nodeId, attributeId, callback) {
    var self = this;

    nodeId = resolveNodeId(nodeId);
    assert(nodeId instanceof NodeId);

    var index = nodeId.toString() + &quot;_&quot; + attributeId.toString();

    if (self.has_cache_NodeAttribute(nodeId, attributeId)) {
        callback(null, self.get_cache_NodeAttribute(nodeId, attributeId));
    } else {

        self.browseNameMap[index] = &quot;?&quot;;
        self._nodesToReadEx.push({
            nodeToRead: {
                nodeId: nodeId,
                attributeId: AttributeIds.BrowseName
            },
            callback: function (dataValue) {
                self.set_cache_NodeAttribute(nodeId, attributeId, dataValue);
                callback(null, dataValue);
            }
        });
    }
};

/**
 * perform pending read Node operation
 * @method _resolve_deferred_readNode
 * @param callback {Function}
 * @private
 */
NodeCrawler.prototype._resolve_deferred_readNode = function (callback) {

    var self = this;
    if (self._nodesToReadEx.length === 0) {
        // nothing to read
        callback();
        return;
    }

    var _nodesToReadEx = _fetch_elements(self._nodesToReadEx, self.maxNodesPerRead);

    var nodesToRead = _nodesToReadEx.map(function (e) {
        return e.nodeToRead;
    });

    self.session.read(nodesToRead, function (err, nodesToRead, results /*, diagnostics*/) {

        if (!err) {

            _.zip(_nodesToReadEx, results).forEach(function (pair) {
                var _nodeToReadEx = pair[0];

                var dataValue = pair[1];
                assert(dataValue.hasOwnProperty(&quot;statusCode&quot;));
                if (dataValue.statusCode === StatusCodes.Good) {
                    _nodeToReadEx.callback(dataValue.value.value);
                } else {
                    _nodeToReadEx.callback({name: dataValue.statusCode.key});
                }

            });
        }
        callback(err);
    });
};

NodeCrawler.prototype._resolve_deferred = function (comment, collection, method) {
    var self = this;

    if (collection.length &gt; 0) {
        self._push_task(&quot;adding operation &quot; + comment, {
            params: {},
            func: function (task, callback) {
                method.call(self, callback);
            }
        });
    }
};

NodeCrawler.prototype.resolve_deferred_readNode = function () {
    this._resolve_deferred(&quot;read_node&quot;, this._nodesToReadEx, this._resolve_deferred_readNode);
};

NodeCrawler.prototype.resolve_deferred_browseNode = function () {
    this._resolve_deferred(&quot;browse_node&quot;, this._objectToBrowse, this._resolve_deferred_browseNode);
};


/**
 * perform a deferred browse
 * instead of calling session.browse directly, this function add the request to a list
 * so that request can be grouped and send in one single browse command to the server.
 *
 * @method _defer_browse_node
 * @private
 * @param nodeId
 * @param callback
 */
NodeCrawler.prototype._defer_browse_node = function (nodeId, callback) {

    var self = this;

    var index = resolveNodeId(nodeId).toString();

    if (self._objectCache.hasOwnProperty(index)) {

        var object = self._objectCache[index];
        assert(object.browseName.name !== &quot;pending&quot;);
        return callback(null, object);

    } else {

        var element = {
            nodeId: nodeId,
            browseName: {name: &quot;pending&quot;},
            //references by types
            references: null
        };

        assert(!self._objectCache.hasOwnProperty(index));
        self._objectCache[index] = element;

        self._objectToBrowse.push({
            nodeId: nodeId,
            browseDirection: BrowseDirection.Forward,
            //attributeId: AttributeIds.BrowseName
            callback: function (object) {
                object.references = object.references || [];
                assert(object === element);
                assert(object.browseName.name !== &quot;pending&quot;);
                callback(null, object);
            },
            element: element
        });
    }
};


NodeCrawler.prototype._process_browse_response = function (task, callback) {
    /* jshint validthis: true */
    var self = this;

    var _objectsToBrowse = task.param._objectsToBrowse;
    var results = task.param.results;

    _.zip(_objectsToBrowse, results).forEach(function (pair) {
        var _objectToBrowse = pair[0];

        var index = _objectToBrowse.nodeId.toString();
        var obj = self._objectCache[index];
        assert(obj === _objectToBrowse.element);

        obj.references = pair[1].references;

        self._defer_readNode(obj.nodeId, AttributeIds.BrowseName, function (err, browseName) {

            debugLog(&quot; NodeCrawler&quot;.cyan, &quot; setting name = &quot;.yellow, browseName, &quot; on &quot;, obj.nodeId.toString(), err ? err.message : null);
            obj.browseName = browseName;

            _objectToBrowse.callback(obj);
        });
    });
    callback();
};

//                         &quot;ReferenceType | IsForward | BrowseName | NodeClass | DisplayName | TypeDefinition&quot;
var resultMask = opcua.browse_service.makeResultMask(&quot;ReferenceType | IsForward | BrowseName | NodeClass | TypeDefinition&quot;);

NodeCrawler.prototype._resolve_deferred_browseNode = function (callback) {

    var self = this;

    if (self._objectToBrowse.length === 0) {
        callback();
        return;
    }

    var _objectsToBrowse = _fetch_elements(self._objectToBrowse, self.maxNodesPerBrowse);

    var nodesToBrowse = _objectsToBrowse.map(function (e) {
        return new BrowseDescription({
            browseDirection: BrowseDirection.Forward,
            nodeId: e.nodeId,
            resultMask: resultMask
        });
    });

    self.session.browse(nodesToBrowse, function (err, results /*, diagnostics*/) {

        if (!err) {
            assert(results.length === nodesToBrowse.length);
            self._shift_task(&quot;process browse result&quot;, {
                param: {
                    _objectsToBrowse: _objectsToBrowse,
                    results: results,
                },
                func: NodeCrawler.prototype._process_browse_response
            });

        } else {
            console.log(&quot;ERROR = &quot;, err);
        }
        callback(err);

    });
};

NodeCrawler.prototype._shift_task = function (name, task) {
    var self = this;
    assert(_.isFunction(task.func));
    task.comment = &quot;S:&quot; + name;
    assert(task.func.length === 2);
    self.q.unshift(task);
};

NodeCrawler.prototype._push_task = function (name, task) {
    var self = this;
    assert(_.isFunction(task.func));
    task.comment = &quot;P:&quot; + name;
    assert(task.func.length === 2);
    self.q.push(task);
};

NodeCrawler.prototype._emit_on_crawled = function (element) {
    var self = this;
    self.emit(&quot;browsed&quot;, element);
};

NodeCrawler.prototype._crawl = function (task, callback) {
    /* jshint validthis: true */
    var self = this;
    var _visited_node = self._visited_node;

    var nodeId = task.params.nodeId;

    nodeId = resolveNodeId(nodeId);

    var index = nodeId.toString();

    if (_visited_node.hasOwnProperty(index)) {
        console.log(&quot;skipping already visited&quot;, index);
        callback();
        return;// already visited
    }
    // mark as visited to avoid infinite recursion
    _visited_node[index] = true;

    self._defer_browse_node(nodeId, function (err, object) {

        if (!err) {

            var i = 0;
            for (i = 0; i &lt; object.references.length; i++) {

                var reference = object.references[i];

                // this one comes for free
                if (!self.has_cache_NodeAttribute(reference.nodeId, AttributeIds.BrowseName)) {
                    self.set_cache_NodeAttribute(reference.nodeId, AttributeIds.BrowseName, reference.browseName);
                }
                self._add_crawl_task(reference.referenceTypeId);
                self._add_crawl_task(reference.nodeId);
            }
            self._emit_on_crawled(object);
        }
    });
    callback();
};


NodeCrawler.prototype._add_crawl_task = function (nodeId) {
    /* jshint validthis: true */
    var self = this;
    assert(_.isObject(self));
    var _crawled = self._crawled;
    assert(_.isObject(_crawled));

    var index = nodeId.toString();
    if (_crawled.hasOwnProperty(index)) {
        return;
    }
    _crawled[index] = 1;
    self._push_task(&quot;_crawl task&quot;, {
        params: {nodeId: nodeId},
        func: NodeCrawler.prototype._crawl
    });

};

NodeCrawler.prototype._inner_crawl = function (nodeId, user_data, end_callback) {

    var self = this;
    assert(_.isFunction(end_callback));

    self._visited_node = {};
    self._crawled = {};

    var _has_ended = false;
    self.q.drain = function () {
        if (!_has_ended) {
            _has_ended = true;
            self.emit(&quot;end&quot;);
            end_callback();
        }
    };
    self._add_crawl_task(nodeId);
};

/**
 * @method crawl
 * @param nodeId {NodeId}
 * @param user_data {Object}
 * @param end_callback {Function}
 */
NodeCrawler.prototype.crawl = function (nodeId, user_data, end_callback) {
    assert(_.isFunction(end_callback));
    var self = this;
    self._readOperationalLimits(function (err) {

        if (err) {
            return end_callback(err);
        }
        self._inner_crawl(nodeId, user_data, end_callback);
    });
};

function lowerize(str) {
    if (str === undefined) {
        return str;
    }
    return str.substring(0, 1).toLowerCase() + str.substring(1);
}

function remove_cycle(object, callback) {


    var visitedNodeIds = {};

    function hasBeenVisited(e) {
        var key = e.nodeId.toString();
        return visitedNodeIds[key];
    }

    function setVisited(e) {
        var key = e.nodeId.toString();
        return visitedNodeIds[key] = e;
    }

    function mark_array(arr) {
        if (!arr) { return; }
        assert(_.isArray(arr));
        for (var index = 0; index &lt; arr.length; index++) {
            var e = arr[index];
            if (hasBeenVisited(e)) {
                return;
            } else {
                setVisited(e);
                explorerObject(e);
            }
        }
    }

    function explorerObject(obj) {
        mark_array(obj.organizes);
        mark_array(obj.hasComponent);
        mark_array(obj.hasNotifier);
        mark_array(obj.hasProperty);
    }


    explorerObject(object);
    callback(null,object);
}

NodeCrawler.prototype.read = function (nodeId, callback) {

    var self = this;

    try {
        nodeId = resolveNodeId(nodeId);
    } catch (err) {
        callback(err);
    }

    function simplify_object(objMap, object, final_callback) {

        assert(_.isFunction(final_callback));

        var queue = async.queue(function (task, callback) {

            setImmediate(function () {
                assert(_.isFunction(task.func));
                task.func(task.data, callback);
            });
        }, 1);

        var index = object.nodeId.toString();

        function add_for_reconstruction(object, extra_func) {
            assert(_.isFunction(extra_func));
            assert(typeof object.nodeId.toString() === &quot;string&quot;);
            queue.push({
                data: object,
                func: function (data, callback) {

                    _reconstruct_manageable_object(data, function (err, obj) {
                        extra_func(err, obj);
                        callback(err);
                    });
                }
            });
        }

        function _reconstruct_manageable_object(object, callback) {

            assert(_.isFunction(callback));
            assert(object);
            assert(object.nodeId);

            var index = object.nodeId.toString();

            if (objMap.hasOwnProperty(index)) {
                return callback(null, objMap[index]);
            }
            /* reconstruct a more manageable object
             * var obj = {
             *    browseName: &quot;Objects&quot;,
             *    organises : [
             *       {
             *            browseName: &quot;Server&quot;,
             *            hasComponent: [
             *            ]
             *            hasProperty: [
             *            ]
             *       }
             *    ]
             * }
             */
            var obj = {
                browseName: object.browseName.name,
                nodeId: object.nodeId.toString()
            };

            // Append nodeClass
            if (object.nodeClass) {
                obj.nodeClass = object.nodeClass.toString();
            }

            objMap[index] = obj;

            var referenceMap = obj;

            object.references = object.references || [];


            object.references.map(function (ref) {

                var ref_index = ref.referenceTypeId.toString();

                var referenceType = self._objectCache[ref_index];

                if (!referenceType) {
                    console.log((&quot;Unknown reference type &quot; + ref_index).red.bold);
                    console.log(util.inspect(object, {colorize: true, depth: 10}));
                }
                var reference = self._objectCache[ref.nodeId.toString()];

                // Extract nodeClass so it can be appended
                reference.nodeClass = ref.$nodeClass;

                var refName = lowerize(referenceType.browseName.name);

                if (refName === &quot;hasTypeDefinition&quot;) {
                    obj.typeDefinition = reference.browseName.name;
                } else {
                    if (!referenceMap[refName]) {
                        referenceMap[refName] = [];
                    }
                    add_for_reconstruction(reference, function (err, mobject) {
                        if (!err) {
                            referenceMap[refName].push(mobject);
                        }
                    });
                }
            });
            callback(null, obj);

        }

        add_for_reconstruction(object, function () {
        });

        queue.drain = function () {
            var object = self._objMap[index];
            remove_cycle(object, callback);
        };
    }

    var index = nodeId.toString();

    // check if object has already been crawled
    if (self._objMap.hasOwnProperty(index)) {
        var object = self._objMap[index];
        return callback(null, object);
    }

    self.crawl(nodeId, {}, function () {

        if (self._objectCache.hasOwnProperty(index)) {

            var object = self._objectCache[index];
            assert(object.browseName.name !== &quot;pending&quot;);

            simplify_object(self._objMap, object, callback);

        } else {
            callback(new Error(&quot;Cannot find nodeid&quot; + index));
        }
    });
};

exports.NodeCrawler = NodeCrawler;


    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
